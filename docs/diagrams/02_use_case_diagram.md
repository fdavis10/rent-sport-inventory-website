# Диаграмма Use Case (Варианты использования)

## Описание

Диаграмма описывает основные функциональные требования к системе аренды спортивного инвентаря.

---

## Актёры (Actors)

1. **Клиент (Client)** - обычный пользователь системы
2. **Менеджер (Manager)** - сотрудник, управляющий заказами
3. **Администратор (Admin)** - полный доступ к системе

---

## Варианты использования

### Для всех ролей (без авторизации):

- **UC-01:** Просмотр каталога инвентаря
- **UC-02:** Поиск инвентаря
- **UC-03:** Фильтрация по категориям
- **UC-04:** Сортировка товаров
- **UC-05:** Просмотр детальной информации о товаре
- **UC-06:** Регистрация в системе
- **UC-07:** Авторизация в системе

---

### Для роли "Клиент":

- **UC-08:** Добавление товара в корзину
- **UC-09:** Просмотр корзины
- **UC-10:** Изменение количества в корзине
- **UC-11:** Удаление из корзины
- **UC-12:** Расчет стоимости аренды (Калькулятор)
- **UC-13:** Оформление заказа
- **UC-14:** Просмотр своих заказов
- **UC-15:** Просмотр детальной информации о заказе
- **UC-16:** Редактирование профиля
- **UC-17:** Написание отзыва
- **UC-18:** Выход из системы

---

### Для роли "Менеджер":

Все функции клиента +

- **UC-19:** Просмотр всех заказов
- **UC-20:** Подтверждение заказа
- **UC-21:** Изменение статуса заказа
- **UC-22:** Просмотр статистики аренды
- **UC-23:** Доступ к админ-панели

---

### Для роли "Администратор":

Все функции менеджера +

- **UC-24:** Управление пользователями (CRUD)
- **UC-25:** Управление категориями (CRUD)
- **UC-26:** Управление инвентарем (CRUD)
- **UC-27:** Управление заказами (полный доступ)
- **UC-28:** Назначение ролей пользователям
- **UC-29:** Экспорт/импорт данных
- **UC-30:** Просмотр логов системы

---

## Текстовое представление диаграммы
```
                    ┌─────────────────────────────────────────┐
                    │    Система аренды спортинвентаря        │
                    └─────────────────────────────────────────┘
                                      │
        ┌─────────────────────────────┼─────────────────────────────┐
        │                             │                             │
        │                             │                             │
   ┌────▼────┐                   ┌────▼────┐                  ┌────▼────┐
   │ Клиент  │                   │Менеджер │                  │  Админ  │
   └────┬────┘                   └────┬────┘                  └────┬────┘
        │                             │                             │
        │                             │                             │
┌───────▼───────────────┐     ┌───────▼───────────────┐    ┌────────▼────────┐
│ Гостевые функции:     │     │ Менеджер функции:     │    │ Админ функции:  │
├───────────────────────┤     ├───────────────────────┤    ├─────────────────┤
│ • Просмотр каталога   │     │ + Все функции клиента │    │ + Все функции   │
│ • Поиск товаров       │     │ • Просмотр всех       │    │   менеджера     │
│ • Фильтрация          │     │   заказов             │    │ • Управление    │
│ • Сортировка          │     │ • Подтверждение       │    │   пользователями│
│ • Просмотр детально   │     │   заказов             │    │ • Управление    │
│ • Регистрация         │     │ • Изменение статуса   │    │   категориями   │
│ • Авторизация         │     │ • Статистика          │    │ • Управление    │
└───────────────────────┘     │ • Админ-панель        │    │   инвентарем    │
        │                     └───────────────────────┘    │ • Назначение    │
        │                                                   │   ролей         │
┌───────▼───────────────┐                                  │ • Экспорт/импорт│
│ Клиент функции:       │                                  └─────────────────┘
├───────────────────────┤
│ • Добавление в        │
│   корзину             │
│ • Просмотр корзины    │
│ • Изменение           │
│   количества          │
│ • Удаление из         │
│   корзины             │
│ • Калькулятор         │◄───── (UC-12) ВАЖНО для практики!
│   стоимости           │
│ • Оформление заказа   │
│ • Мои заказы          │
│ • Редактирование      │
│   профиля             │
│ • Написание отзыва    │
│ • Выход               │
└───────────────────────┘
```

---

## Детализация ключевых вариантов использования

### UC-12: Расчет стоимости аренды (Калькулятор)

**Актёр:** Клиент  
**Цель:** Рассчитать стоимость аренды с учетом скидок

**Предусловия:**
- Пользователь авторизован
- Товар доступен для аренды

**Основной сценарий:**
1. Клиент выбирает товар
2. Клиент указывает количество
3. Клиент выбирает даты начала и окончания
4. Система автоматически рассчитывает:
   - Количество дней = (Дата окончания - Дата начала) + 1
   - Базовая стоимость = Цена за день × Количество × Дни
   - Скидка (если применима):
     - 10% при аренде ≥ 7 дней
     - 5% при аренде ≥ 3 дней
   - Итоговая стоимость = Базовая стоимость - Скидка
5. Система отображает детальный расчет
6. Клиент может изменить параметры, расчет обновляется автоматически

**Альтернативные сценарии:**
- A1: Дата начала в прошлом → Ошибка
- A2: Дата окончания раньше даты начала → Ошибка

---

### UC-13: Оформление заказа

**Актёр:** Клиент  
**Предусловия:** В корзине есть товары

**Основной сценарий:**
1. Клиент переходит в корзину
2. Клиент нажимает "Оформить заказ"
3. Система отображает итоговую информацию
4. Клиент добавляет комментарий (опционально)
5. Клиент подтверждает заказ
6. Система:
   - Создает заказ со статусом PENDING
   - Переносит позиции из корзины в заказ
   - Уменьшает quantity_available инвентаря
   - Очищает корзину
   - Отправляет уведомление клиенту
7. Система перенаправляет на страницу заказа

**Альтернативные сценарии:**
- A1: Корзина пуста → Редирект в каталог
- A2: Товар стал недоступен → Ошибка, удаление из корзины

---

### UC-20: Подтверждение заказа (Менеджер)

**Актёр:** Менеджер  
**Предусловия:** Есть заказы со статусом PENDING

**Основной сценарий:**
1. Менеджер открывает список заказов в админке
2. Менеджер выбирает заказ
3. Менеджер проверяет детали
4. Менеджер изменяет статус на CONFIRMED
5. Система:
   - Обновляет статус
   - Сохраняет время подтверждения
   - Сохраняет ID менеджера
   - Отправляет уведомление клиенту

---

## Матрица доступа к функциям

| Функция | Гость | Клиент | Менеджер | Админ |
|---------|-------|--------|----------|-------|
| Просмотр каталога | ✅ | ✅ | ✅ | ✅ |
| Поиск/фильтрация | ✅ | ✅ | ✅ | ✅ |
| Регистрация | ✅ | ❌ | ❌ | ❌ |
| Авторизация | ✅ | ❌ | ❌ | ❌ |
| Корзина | ❌ | ✅ | ✅ | ✅ |
| Калькулятор | ❌ | ✅ | ✅ | ✅ |
| Оформление заказа | ❌ | ✅ | ✅ | ✅ |
| Мои заказы | ❌ | ✅ | ✅ | ✅ |
| Все заказы | ❌ | ❌ | ✅ | ✅ |
| Подтверждение заказов | ❌ | ❌ | ✅ | ✅ |
| Управление инвентарем | ❌ | ❌ | ❌ | ✅ |
| Управление пользователями | ❌ | ❌ | ❌ | ✅ |